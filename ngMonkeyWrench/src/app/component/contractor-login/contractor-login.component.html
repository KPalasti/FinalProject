<app-contractor-sidebar>Loading...</app-contractor-sidebar>
<!-- Page content -->

<div class='selectBusiness'>
  <div class="col">
    <h1>Welcome {{currentUser.firstName}}  {{currentUser.lastName}}</h1><br>
    <div ngbDropdown class="d-inline-block">
      <button class="btn btn-outline-primary" id="dropdownBasic1" ngbDropdownToggle>Select Business</button>
      <div ngbDropdownMenu aria-labelledby="dropdownBasic1" *ngFor='let business of userBusinesses'>
        <button ngbDropdownItem (click)='getServiceCallsByBusinessId(business)'>{{ business.name }}</button>
      </div>
    </div>
  </div>
</div>

<div class="content" *ngIf="showCalls">
  <H1>Service Requests:</H1>
  <br>
  <div class="wrapper radioDatePipe">
    <form action="">
      <input [(ngModel)]="filterBy" type="radio" id="day" name="filterBy" value="day">
      <label for="day"> Day</label>
      <input [(ngModel)]="filterBy" type="radio" id="week" name="filterBy" value="week">
      <label for="week"> Week</label>
      <input [(ngModel)]="filterBy" type="radio" id="month" name="filterBy" value="month">
      <label for="month"> Month</label>
      <input [(ngModel)]="filterBy" type="radio" id="all" name="filterBy" value="all">
      <label for="All">  All</label>
    </form>
    </div>
    <br>
    <br>
    <div class="clientListBox container-fluid" >
      <div>
        <h2>In Progress: </h2>
     </div>
      <div >
        <table class="table table-dark">
          <thead>
            <tr>
              <th scope="col">Name</th>
              <th scope="col">Problem</th>
              <th scope="col">Address</th>
              <th scope="col">Scheduled</th>
              <th scope="col">Completed</th>
            </tr>
          </thead>
          <tbody *ngFor='let call of serviceCalls | activeCalls:showComplete | callFilter:filterBy'>
            <tr>
              <td>{{call.user?.firstName}} {{call.user?.lastName}}</td>
              <td>{{call.problem?.description}}</td>
              <td>{{call.address?.street}} {{call.address?.city}} {{call.address?.stateAbbv}}</td>
              <td>{{call.dateScheduled | date  : 'short'}} </td>
              <td><input type="checkbox" name="completed" (change)="completeServiceCall(call)"><br></td>
            </tr>
          </tbody>
        </table>
    </div>
  </div>

